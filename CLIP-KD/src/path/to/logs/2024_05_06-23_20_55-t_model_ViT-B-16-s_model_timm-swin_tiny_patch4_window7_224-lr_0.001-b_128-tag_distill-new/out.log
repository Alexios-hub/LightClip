2024-05-06,23:20:55 | INFO | Added key: store_based_barrier_key:1 to store for rank: 0
2024-05-06,23:20:55 | INFO | Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
2024-05-06,23:20:55 | INFO | Running in distributed mode with multiple processes. Device: cuda:0.Process (global: 0, local 0), total 2.
2024-05-06,23:20:55 | INFO | Loaded timm-swin_tiny_patch4_window7_224 model config.
2024-05-06,23:20:58 | INFO | Loaded ViT-B-16 model config.
2024-05-06,23:21:00 | INFO | Teacher Visual Params:
2024-05-06,23:21:00 | INFO | 86.19264M
2024-05-06,23:21:00 | INFO | Teacher Text Params:
2024-05-06,23:21:00 | INFO | 37.828608M
2024-05-06,23:21:00 | INFO | Student Visual Params:
2024-05-06,23:21:00 | INFO | 27.91257M
2024-05-06,23:21:00 | INFO | Student Text Params:
2024-05-06,23:21:00 | INFO | 21.293568M
2024-05-06,23:21:00 | INFO |   alpha_afd_loss: 0.0
2024-05-06,23:21:00 | INFO |   alpha_ckd_loss: 1.0
2024-05-06,23:21:00 | INFO |   alpha_cross_kd_loss: 0.0
2024-05-06,23:21:00 | INFO |   alpha_fd_loss: 2000.0
2024-05-06,23:21:00 | INFO |   alpha_gd_loss: 0.0
2024-05-06,23:21:00 | INFO |   alpha_icl_loss: 1.0
2024-05-06,23:21:00 | INFO |   batch_size: 128
2024-05-06,23:21:00 | INFO |   beta1: 0.9
2024-05-06,23:21:00 | INFO |   beta2: 0.999
2024-05-06,23:21:00 | INFO |   checkpoint_path: path/to/logs/2024_05_06-23_20_55-t_model_ViT-B-16-s_model_timm-swin_tiny_patch4_window7_224-lr_0.001-b_128-tag_distill-new/checkpoints
2024-05-06,23:21:00 | INFO |   copy_codebase: False
2024-05-06,23:21:00 | INFO |   csv_caption_key: title
2024-05-06,23:21:00 | INFO |   csv_img_key: filepath
2024-05-06,23:21:00 | INFO |   csv_separator: 	
2024-05-06,23:21:00 | INFO |   data_root: path/to/cc3m/images/,path/to/cc12m/images/
2024-05-06,23:21:00 | INFO |   dataset_resampled: False
2024-05-06,23:21:00 | INFO |   dataset_type: csv
2024-05-06,23:21:00 | INFO |   ddp_static_graph: False
2024-05-06,23:21:00 | INFO |   debug: False
2024-05-06,23:21:00 | INFO |   device: cuda:0
2024-05-06,23:21:00 | INFO |   dist_backend: nccl
2024-05-06,23:21:00 | INFO |   dist_url: env://
2024-05-06,23:21:00 | INFO |   distributed: True
2024-05-06,23:21:00 | INFO |   epochs: 32
2024-05-06,23:21:00 | INFO |   eps: 1e-08
2024-05-06,23:21:00 | INFO |   eval: False
2024-05-06,23:21:00 | INFO |   force_custom_text: False
2024-05-06,23:21:00 | INFO |   force_quick_gelu: False
2024-05-06,23:21:00 | INFO |   gather_with_grad: False
2024-05-06,23:21:00 | INFO |   grad_checkpointing: False
2024-05-06,23:21:00 | INFO |   grad_clip_norm: None
2024-05-06,23:21:00 | INFO |   horovod: False
2024-05-06,23:21:00 | INFO |   image_mean: None
2024-05-06,23:21:00 | INFO |   image_std: None
2024-05-06,23:21:00 | INFO |   imagenet_a: None
2024-05-06,23:21:00 | INFO |   imagenet_r: None
2024-05-06,23:21:00 | INFO |   imagenet_sketch: None
2024-05-06,23:21:00 | INFO |   imagenet_v2: None
2024-05-06,23:21:00 | INFO |   imagenet_val: path/to/imagenet/val/
2024-05-06,23:21:00 | INFO |   local_loss: False
2024-05-06,23:21:00 | INFO |   local_rank: 0
2024-05-06,23:21:00 | INFO |   lock_image: False
2024-05-06,23:21:00 | INFO |   lock_image_freeze_bn_stats: False
2024-05-06,23:21:00 | INFO |   lock_image_unlocked_groups: 0
2024-05-06,23:21:00 | INFO |   lock_text: False
2024-05-06,23:21:00 | INFO |   lock_text_freeze_layer_norm: False
2024-05-06,23:21:00 | INFO |   lock_text_unlocked_layers: 0
2024-05-06,23:21:00 | INFO |   log_level: 20
2024-05-06,23:21:00 | INFO |   log_local: False
2024-05-06,23:21:00 | INFO |   log_path: path/to/logs/2024_05_06-23_20_55-t_model_ViT-B-16-s_model_timm-swin_tiny_patch4_window7_224-lr_0.001-b_128-tag_distill-new/out.log
2024-05-06,23:21:00 | INFO |   logs: path/to/logs/
2024-05-06,23:21:00 | INFO |   lr: 0.001
2024-05-06,23:21:00 | INFO |   mask_ratio: 0.0
2024-05-06,23:21:00 | INFO |   model: timm-swin_tiny_patch4_window7_224
2024-05-06,23:21:00 | INFO |   model_checkpoint: 
2024-05-06,23:21:00 | INFO |   name: 2024_05_06-23_20_55-t_model_ViT-B-16-s_model_timm-swin_tiny_patch4_window7_224-lr_0.001-b_128-tag_distill-new
2024-05-06,23:21:00 | INFO |   no_set_device_rank: False
2024-05-06,23:21:00 | INFO |   num_per_class: 1
2024-05-06,23:21:00 | INFO |   precision: amp
2024-05-06,23:21:00 | INFO |   pretrained: 
2024-05-06,23:21:00 | INFO |   pretrained_image: False
2024-05-06,23:21:00 | INFO |   rank: 0
2024-05-06,23:21:00 | INFO |   report_to: tensorboard
2024-05-06,23:21:00 | INFO |   resume: None
2024-05-06,23:21:00 | INFO |   s_embed_dim: 512
2024-05-06,23:21:00 | INFO |   save_frequency: 1
2024-05-06,23:21:00 | INFO |   save_most_recent: False
2024-05-06,23:21:00 | INFO |   seed: 0
2024-05-06,23:21:00 | INFO |   skip_scheduler: False
2024-05-06,23:21:00 | INFO |   sup_batch_size: 64
2024-05-06,23:21:00 | INFO |   t_embed_dim: 512
2024-05-06,23:21:00 | INFO |   t_eval: False
2024-05-06,23:21:00 | INFO |   t_model: ViT-B-16
2024-05-06,23:21:00 | INFO |   t_model_checkpoint: ./pretrained_models/vit_b_16.pt
2024-05-06,23:21:00 | INFO |   tag: distill-new
2024-05-06,23:21:00 | INFO |   tensorboard: True
2024-05-06,23:21:00 | INFO |   tensorboard_path: path/to/logs/2024_05_06-23_20_55-t_model_ViT-B-16-s_model_timm-swin_tiny_patch4_window7_224-lr_0.001-b_128-tag_distill-new/tensorboard
2024-05-06,23:21:00 | INFO |   torchscript: False
2024-05-06,23:21:00 | INFO |   trace: False
2024-05-06,23:21:00 | INFO |   train_data: path/to/cc3m_train.csv,path/to/cc12m.csv
2024-05-06,23:21:00 | INFO |   train_num_samples: None
2024-05-06,23:21:00 | INFO |   use_bn_sync: False
2024-05-06,23:21:00 | INFO |   val_data: path/to/cc3m_val.csv
2024-05-06,23:21:00 | INFO |   val_data_root: path/to/cc3m/images/
2024-05-06,23:21:00 | INFO |   val_dataset_type: csv
2024-05-06,23:21:00 | INFO |   val_frequency: 1
2024-05-06,23:21:00 | INFO |   val_num_samples: None
2024-05-06,23:21:00 | INFO |   vl_batch_size: 64
2024-05-06,23:21:00 | INFO |   wandb: False
2024-05-06,23:21:00 | INFO |   wandb_notes: 
2024-05-06,23:21:00 | INFO |   warmup: 10000
2024-05-06,23:21:00 | INFO |   wd: 0.1
2024-05-06,23:21:00 | INFO |   workers: 8
2024-05-06,23:21:00 | INFO |   world_size: 2
2024-05-06,23:21:00 | INFO |   zeroshot_frequency: 1
